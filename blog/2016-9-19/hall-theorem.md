---
title: Hall定理
create: 2016.9.19
modified: 2016.9.19
tags: 图论
      二分图
      Hall定理
---

[TOC]
# Hall定理
## 基本形式
Hall定理是一个用于判定**二分图是否具有最大匹配**的定理。
首先对于二分图$G = (X \cup Y, E)$，点集被分为了$X$和$Y$两部分。
是否具有最大匹配，首先一个最基本的条件就是$|X| = |Y|$。
Hall定理则在此基础上给出了一个更强的条件。
首先对于一个点集$T \subseteq X$，定义$\Gamma(T)$如下：
$$
\Gamma(T) = \{v \mid u \rightarrow v \in E,\; u \in T,\; v \in Y\}
$$

即表示$T$中所有点能够直接到达的$Y$中的点的集合。

![bigraph](http://git.oschina.net/riteme/blogimg/raw/master/hall-theorme/bigraph.png)

上图中，$\Gamma(\{1,\;3\}) = \{4,\;5,\;6\}$。
那么Hall条件则用于判断一个二分图是否存在最大匹配。Hall条件如下：
对于**任意**的点集$T \subseteq X$，均存在：
$$
|T| \le |\Gamma(T)|
$$

那么此二分图必定存在最大匹配。

## 证明
这个定理看起来很显然，证明起来也不是很难。
首先我们令$n = |X|$，那么，当$n$等于$0$或$1$时，可以验证是正确的。
我们尝试进行逆向归纳。对于一个$n > 1$的二分图，考虑以下两种情况：

1. 如果对于任意的$T \subseteq X$均满足以下条件：
$$ |\Gamma(T)| \ge |T| + 1 $$
那么我们可以删除图中任意一条边作为匹配。由于每个子集均满足以上条件，那么从$X$和$Y$中各删除一个点不会导致违反Hall条件，所以此操作可以使归纳继续并且使$n$减小。
2. 如果存在一个**最大的**$T \subset X$，满足以下条件：
$$ |\Gamma(T)| = |T| $$
那么我们可以明确两点：第一，在$T$中我们可以找到一个关于$T$的最大匹配；第二，将这个匹配从图中删去，剩下的图依然满足Hall条件。因为根据Hall条件易知每一个$X$中的点必定至少与一个$Y$中的点有连边关系。同时Hall条件还表明，不存在一个不属于$T$的点，只与$\Gamma(T)$中的点有边相连。故删除它们不会造成有点的出度变为$0$，从而满足了Hall条件。

因此可以通过归纳证明Hall定理。

## 简单运用
Hall定理一般没有什么优化算法复杂度上的用途，但是可以作为一个**比较好的思维工具**。
例如下面这个问题：
[[Russian Code Cup 2016 - Finals] A. Closing ceremony](http://codeforces.com/problemset/problem/720/A)

大意是有一个$n\times m$的网格和$n \times m$个人，每个人都要走到一个网格上的一点，每个点只能装下一个人。
同时定义两个点之间的距离为曼哈顿距离，每个人有自己行走的路程上限。
现在这$n \times m$个人分成两批，从$(0,\;0)$和$(0,\;m+1)$出发，问你是否存在一种安排每个人的最终位置的方案，来满足每个人走到对应位置时的路程不超过自己的上限。

令点$A$为$(0,\;0)$，点$B$为$(0,\;m+1)$。并且设$f(i,\;j)$表示离$A$距离至少为$i$，离$B$距离至少为$j$的格子的个数。
设$S_A(i)$表示在$A$最远距离至少为$i$的人数，同理，$S_B(i)$表示在$B$处最远距离至少为$i$的人数。由于每个人和一个位置形成了一个一一对应的关系，由此我们可以构建一个二分图，并且我们所要做的就是判定这个二分图是否具有最大匹配。
事实上由于存在单调性，利用Hall定理可以知道，我们只用判定是否对于所有的$f(i,\;j)$均不大于$S_A(i) + S_B(j)$，如果满足这个条件，那么这个二分图就有最大匹配。
那么现在的问题就是求得$f$。由于曼哈顿距离为$i$的等距线实际上是一条斜率为$1$或$-1$的直线，所以$f(i,\;j)$就是两条直线在网格中围成的面积。
并且注意到它可以递归计算：
$$
f(i,\;j) = f(i+1,\;j) + f(i,\;j+1) - f(i+1,\;j+1)
$$

并且需要考虑这两条直线的交点是否会占用一个格子。所以我们的做法就是枚举交点，确定是那两条直线相交，并且赋给对应的$f$去，然后对$f$计算后缀和就是我们想要的东西啦～
